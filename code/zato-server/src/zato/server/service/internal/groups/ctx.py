'''# -*- coding: utf-8 -*-

"""
Copyright (C) 2024, Zato Source s.r.o. https://zato.io

Licensed under AGPLv3, see LICENSE.txt for terms and conditions.
"""

# gevent
from gevent.lock import RLock

# Zato
from zato.server.service import Service

# ################################################################################################################################
# ################################################################################################################################

if 0:
    from zato.common.typing_ import intlist, intset, strdict
    from zato.server.base.parallel import ParallelServer

# ################################################################################################################################
# ################################################################################################################################

class _BasicAuthSecDef:
    id: 'int'
    password: 'str'

# ################################################################################################################################
# ################################################################################################################################

class _APIKeySecDef:
    id: 'int'
    value: 'str'

# ################################################################################################################################
# ################################################################################################################################

class SecurityGroupCtx:

    channel_id: 'int'
    security_groups: 'intset'

    basic_auth_credentials: 'strdict'
    apikey_credentials: 'strdict'

    def __init__(self) -> 'None':
        self.basic_auth_credentials = {}
        self.apikey_credentials = {}
        self._lock = RLock()

# ################################################################################################################################

    def check_security_basic_auth(self, username:'str', password:'str') -> 'bool':
        pass

# ################################################################################################################################

    def edit_basic_auth(self, security_id:'int') -> 'None':
        with self._lock:
            pass

# ################################################################################################################################

    def delete_basic_auth(self, security_id:'int') -> 'None':
        with self._lock:
            pass

# ################################################################################################################################

    def check_security_apikey(self, header:'str', value:'str') -> 'bool':
        pass

# ################################################################################################################################
# ################################################################################################################################

class SecurityGroupCtxBuilder:

    def __init__(self, server:'ParallelServer') -> 'None':
        self.server = server

    def build_ctx(self, channel_id:'int', security_groups: 'intlist') -> 'SecurityGroupCtx':

        ctx = SecurityGroupCtx()
        ctx.channel_id = channel_id
        ctx.security_groups = set(security_groups)

        return ctx

# ################################################################################################################################
# ################################################################################################################################

class BuildCtx(Service):
    name = 'dev.groups.build-ctx'

    def handle(self):
        pass

# ################################################################################################################################
# ################################################################################################################################
'''
